--- 
title: "An Introduction to Spatial Data Analysis and Statistics: A Course in `R`"
author: "Antonio Paez"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
output: 
  bookdown::gitbook:
    config:
      toc:
        collapse: subsection
        scroll_highlight: true
        before: null
        after: null
      toolbar:
        position: fixed
      edit : null
      download: null
      search:
        engine: lunr # or fuse
      # options to control/tune search engine behavior (for
      # fuse.js, refer to https://fusejs.io/api/options.html)
        options: null
      fontsettings:
        theme: white
        family: sans
        size: 2
      sharing:
        facebook: false
        github: true
        linkedin: true
        twitter: false
        whatsapp: true
      info: true            
documentclass: book
bibliography: [bibliography.bib, packages.bib]
biblio-style: apalike
link-citations: yes
github-repo: paezha/spatial-analysis-R
description: "This book was created as a resource for teaching applied spatial statistics at McMaster University by Antonio Paez, with support from Anastassios Dardas, Rajveer Ubhi, Megan Coad and Alexis Polidoro. Further testing and refinements are due to John Merrall and Anastasia Soukhov. The book is published with support of an Open Educational Resources grant from MacPherson Institute, McMaster University."
graphics: yes
cover-image: "images/cover.jpg"
---

<!--
TO RENDER:
bookdown::render_book(input = ".", config_file = "_bookdown.yml")
-->

<!--
NOTE: echo=is_html does not work

Inspired by [**bookdown**](https://github.com/rstudio/bookdown) and the Free and Open Source Software for Geospatial ([FOSS4G](http://foss4g.org/)) movement, this book is open source.
This ensures its contents are reproducible and publicly accessible for people worldwide.
The online version of the book is hosted at [geocompr.robinlovelace.net](https://geocompr.robinlovelace.net) and kept up-to-date by [GitHub 
  Actions](https://github.com/Robinlovelace/geocompr/actions), which provides information on its 'build status' as follows:
[![Actions](https://github.com/Robinlovelace/geocompr/workflows/Render-Book-from-master/badge.svg)](https://github.com/Robinlovelace/geocompr/actions)
-->

# {-}

<!--
```{r cover, echo=FALSE, out.width="100%"}
knitr::include_graphics(rep("images/voronoi_ponyo.gif"))
```
-->

<!-- 
The following code generates the cover image. To change the background images, work with the style.css file in the root directory
-->

<!-- COVER 1 -->
<!--
<div class="cover1">
<img src="images/cover-2021/title-01.gif" alt=""/>
</div>
-->

<!-- COVER 1 -->
<!--
<div class="cover1">
<img src="images/cover-2021/title-02b.png" alt=""/>
</div>
-->

<!-- COVER 2 -->
<!--
<div class="cover2">
<div class="fade-in-text">
<p>An Introduction to Spatial Data Analysis and Statistics</p>
</div>
</div>
-->

<!-- COVER 3b -->
<!--
<div class="header3b">
<img src="images/cover-2021/title-01.gif" alt=""/>
</div>
<div class="cover3"></div>
<div class="bottom3"><p>A Course in R</p></div>
-->

<!-- COVER 3 -->
<!--
<div class="header3">
<div class="fade-in-text">
<p>An Introduction to Spatial Data Analysis and Statistics</p>
</div>
</div>
<div class="cover3"></div>
<div class="bottom3"><p>A Course in R</p></div>
-->

<!-- COVER 4 -->
<!--
<div class="cover4">
<div class="fade-in-text">
<p>An Introduction to Spatial Data Analysis and Statistics</p>
<p class="subtitle">A Course in R</p>
</div>
<img src="images/cover-2021/voronoi_mononoke.gif" alt=""/>
</div>
-->

<!-- COVER 4b -->
<!--
<div class="cover4b">
<div class="fade-in-text">
<p>An Introduction to Spatial Data Analysis and Statistics</p>
<p class="subtitle">A Course in R</p>
</div>
<img src="images/cover-2021/voronoi_mononoke.gif" alt=""/>
</div>
-->

<!-- COVER 5b -->
<div class="cover5b">
<img src="images/cover-2021/title-02b.png"/>
</div>

<!-- COVER 5c -->
<!--
<div class="cover5c">
<img src="images/cover-2021/title-02b.png"/>
</div>
-->
                
# Front Matter {-}

Paez, Antonio (2021)  
*An Introduction to Spatial Data Analysis and Statistics: A Course in R*  
[Publisher]  
ISBN: 978-1-7778515-0-7  
<!-- DOI badge -->
[![DOI](https://zenodo.org/badge/391072865.svg)](https://zenodo.org/badge/latestdoi/391072865)  
In GitHub: https://github.com/paezha/spatial-analysis-r
  
  
Antonio Paez  
School of Earth, Environment and Society  
McMaster University  
Hamilton, Ontario  
Canada  
paezha@mcmaster.ca  
<!-- ORCID badge-->
<a href="https://orcid.org/0000-0001-6912-9919">
<img alt="ORCID logo" src="https://info.orcid.org/wp-content/uploads/2019/11/orcid_16x16.png" width="30" height="30" />
https://orcid.org/0000-0001-6912-9919 
</a>  
<!-- Google Scholar and Publobs icons by https://jpswalsh.github.io/academicons/-->
<a href="https://scholar.google.com/citations?user=bLY377kAAAAJ&hl=en">
<img alt="Google Scholar logo" src="images/google-scholar-square.svg" width="30" height="30" />
</a>  
<a href="https://publons.com/researcher/2897251/antonio-paez/">
<img alt="Publons logo" src="images/publons-square.svg" width="30" height="30" />
</a>
<!-- GitHub icon retrived from https://github.com/logos-->  
<a href="https://github.com/paezha">
<img alt="GitHub logo" src="images/GitHub-Mark-64px.png" width="30" height="30" />
</a>  

## What is this book and who is it for? {-}

Words go here.

## Allied resources {-}

You can find additional resources for students and instructors [here](https://github.com/paezha/spatial-analysis-r#resources-for-students-and-instructors)

## Contributing {-}

An advantage of an Open Educational Resource compared to traditional publishing (besides it being free!) is that it is a live, ongoing project, for as long as anyone cares to keep it alive. If you are using this resource, I would encourage you to contribute to help me improve it, by:

- suggesting improvements to the text, e.g. clarifying unclear sentences, fixing typos (see guidance from [Yihui Xie](https://yihui.name/en/2013/06/fix-typo-in-documentation/));
- proposing changes to the code, e.g. to do things in a more efficient way.

Doing this is as easy as editing a wiki page; use the `Edit` button in the toolbar to make a pull request (you need to have a GitHub account and be able to fork the repository):

[![EDIT ME](images/editme.png)](https://github.com/paezha/spatial-analysis-r/edit/main/index.Rmd)

In addition, please feel free to make requests for features or to develop content (see the project's [issue tracker](https://github.com/paezha/spatial-analysis-r/issues)).

### License

This work is licensed under a Creative Commons [Attribution-NonCommercial-ShareAlike 4.0 International License (CC BY-NC-SA 4.0)](https://creativecommons.org/licenses/by-nc-sa/4.0/). This means that you are free to:

- Share it: you can copy and redistribute the material in any medium or format
- Adapt it: you can remix, transform, and build upon the material

Under the following terms:

- Attribution: You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use.

- NonCommercial: You may not use the material for commercial purposes.

- ShareAlike: If you remix, transform, or build upon the material, you must distribute your contributions under the same license as the original.

- No additional restrictions: You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits.

These freedoms cannot be revoked by the licensor (that is me) as long as you follow the license terms.

```{r license, echo=FALSE, out.width="10%"}
knitr::include_graphics(rep("images/license.png"))
```

<!--
## How to support this project {-}
-->


<!--chapter:end:index.Rmd-->


# Preface {-}

Placeholder


## Spatial Analysis and Spatial Statistics {-}
## Why this Text? {-}
## Plan {-}
## Audience {-}
## Requisites {-}
## Words of Appreciation {-}
## Versioning {-}

<!--chapter:end:00-Front-Matter.Rmd-->


# (PART) Part I: Getting to Know the Technology {-} 

Placeholder


## Introduction
## Learning Objectives
### What is `R`?
## Packages in R

<!--chapter:end:01-Installation.Rmd-->


# Basic Operations and Data Structures in `R` {#basic-operations}

Placeholder


## Learning Objectives
## RStudio IDE
## Some Basic Operations
## Data Classes in R
## Data Types in R
## Indexing and Data Transformations
## Visualization
## Creating a Simple Map
## Examples of digital cartography in `R`
## References

<!--chapter:end:02-Basic-Operations-and-Data-Structures.Rmd-->


# (PART) Part II: Statistics and Maps {-}
# Introduction to Mapping in `R` {#introduction-to-maps}

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Packages
## Exploring Dataframes and a Simple Proportional Symbols Map
## Improving on the Proportional Symbols Map
## Some Simple Spatial Analysis
## Other Resources

<!--chapter:end:03-Introduction-to-Mapping.Rmd-->


# Activity: Statistical Maps I

Placeholder


## Housekeeping Questions
## Learning Objectives
## Preliminaries
## Creating a simple thematic map
## Activity

<!--chapter:end:04-Activity-Statistical-Maps.Rmd-->


# Mapping in R: Continued {#mapping-continued}

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Summarizing a Dataframe
## Factors
## Subsetting Data
## Pipe Operator
## More on Visualization

<!--chapter:end:05-Mapping-in-R-Continued.Rmd-->


# Activity 2: Statistical Maps II

Placeholder


## Housekeeping Questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:06-Activity-Mapping-in-R-Continued.Rmd-->


# Maps as Processes: Null Landscapes, Spatial Processes, and Statistical Maps {#maps-as-processes}

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Random Numbers
## Null Landscapes
## Stochastic Processes
## Simulating Spatial Processes
## Processes and Patterns

<!--chapter:end:07-Maps-as-Processes.Rmd-->


# Activity 3: Maps as Processes

Placeholder


## Practice Questions
## Learning Objectives
## Suggested Reading
## Preliminaries
## Activity

<!--chapter:end:08-Activity-Maps-as-Processes.Rmd-->


# (PART) Part III: Analysis of Point Patterns {-}
# Point Pattern Analysis I {#point-pattern-analysis-i}

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Point Patterns
## Processes and Point Patterns
## Intensity and Density
## Quadrats and Density Maps
## Defining the Region for Analysis

<!--chapter:end:09-Point-Pattern-Analysis-I.Rmd-->


# Activity 4: Point Pattern Analysis I

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:10-Activity-Point-Pattern-Analysis-I.Rmd-->


# Point Pattern Analysis II {#point-patern-analysis-ii}

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## A Quadrat-based Test for Spatial Independence
## Limitations of Quadrat Analysis: Size and Number of Quadrats
## Limitations of Quadrat Analysis: Relative Position of Events
## Kernel Density

<!--chapter:end:11-Point-Pattern-Analysis-II.Rmd-->


# Activity 5: Point Pattern Analysis II

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:12-Activity-Point-Pattern-Analysis-II.Rmd-->


# Point Pattern Analysis III

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Motivation
## Nearest Neighbors
## $G$-function

<!--chapter:end:13-Point-Pattern-Analysis-III.Rmd-->


# Activity 6: Point Pattern Analysis III

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:14-Activity-Point-Pattern-Analysis-III.Rmd-->


# Point Pattern Analysis IV

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Motivation
## F-function
## $\hat{K}$-function

<!--chapter:end:15-Point-Pattern-Analysis-IV.Rmd-->


# Activity 7: Point Pattern Analysis IV

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:16-Activity-Point-Pattern-Analysis-IV.Rmd-->


# Point Pattern Analysis V

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Motivation: Hypothesis Testing
## Null Landscapes Revisited
## Simulation Envelopes
## Things to Keep in Mind!
### Definition of a Region
### Edge Effects
### Sampled Point Patterns

<!--chapter:end:17-Point-Pattern-Analysis-V.Rmd-->


# Activity 8: Point Pattern Analysis V

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:18-Activity-Point-Pattern-Analysis-V.Rmd-->


# (PART) Part IV: Data in Areal Units {-}
# Area Data I

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Area Data
## Processes and Area Data
## Visualizing Area Data: Choropleth Maps
## Visualizing Area Data: Cartograms

<!--chapter:end:19-Area-Data-I.Rmd-->


# Activity 9: Area Data I

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:20-Activity-Area-Data-I.Rmd-->


# Area Data II

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Proximity in Area Data
## Spatial Weights Matrices
## Creating Spatial Weights Matrices in `R`
## Spatial Moving Averages
## Other Criteria for Coding Proximity

<!--chapter:end:21-Area-Data-II.Rmd-->


# Activity 10: Area Data II

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:22-Activity-Area-Data-II.Rmd-->


# Area Data III

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Spatial Moving Averages and Simulation
## The Spatial Moving Average as a Smoother
## Spatial Moving Average Scatterplots
## Spatial Autocorrelation and Moran's $I$ coefficient
## Moran's $I$ and Moran's Scatterplot
## Hypothesis Testing for Spatial Autocorrelation

<!--chapter:end:23-Area-Data-III.Rmd-->


# Activity 11: Area Data III

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:24-Activity-Area-Data-III.Rmd-->


# Area Data IV

Placeholder


## Learning objectives
## Suggested readings
## Preliminaries
## Decomposing Moran's $I$
## Local Moran's $I$ and Mapping
## A Quick Note on Functions
## A Concentration approach for Local Analysis of Spatial Association
## A Short Note on Hypothesis Testing
## Detection of Hot and Cold Spots
## Other Resources

<!--chapter:end:25-Area-Data-IV.Rmd-->


# Activity 12: Area Data IV

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:26-Activity-Area-Data-IV.Rmd-->


# Area Data V

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Regression Analysis in `R`
## Autocorrelation as a Model Diagnostic
## Variable Transformations
## A Note about Spatial Autocorrelation in Regression Analysis

<!--chapter:end:27-Area-Data-V.Rmd-->


# Activity 13: Area Data V

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:28-Activity-Area-Data-V.Rmd-->


# Area Data VI

Placeholder


## Learning Objectives
## Suggested Readings
## Preliminaries
## Residual spatial autocorrelation revisited
### Incorrect Functional Form
### Omitted Variables
## Remedial Action
## Flexible Functional Forms and Models with Spatially-varying Coefficients
### Trend Surface Analysis
### Models with Spatially-varying Coefficients
#### Expansion Method
#### Geographically Weighted Regression (GWR)
## Spatial Error Model (SEM)

<!--chapter:end:29-Area-Data-VI.Rmd-->


# Activity 14: Area Data VI

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
### New York leukemia data
### Pennsylvania lung cancer
## Activity

<!--chapter:end:30-Activity-Area-Data-VI.Rmd-->


# (PART) Part V: Analysis and Prediction of Fields {-}
# Spatially Continuous Data I {#spatially-continuous-data-i}

Placeholder


## Learning objectives
## Suggested readings
## Preliminaries
## Spatially continuous (field) data
## Exploratory visualization
## Tile-based methods
## Inverse distance weighting (IDW)
## $k$-point means

<!--chapter:end:31-Spatially-Continuous-Data-I.Rmd-->


# Activity 15: Spatially Continuous Data I

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:32-Activity-Spatially-Continuous-Data-I.Rmd-->


# Spatially Continuous Data II

Placeholder


## Learning objectives
## Suggested readings
## Preliminaries
## Uncertainty in the predictions
## Trend surface analysis
## Accuracy and precision

<!--chapter:end:33-Spatially-Continuous-Data-II.Rmd-->


# Activity 16: Spatially Continuous Data II

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:34-Activity-Spatially-Continuous-Data-II.Rmd-->


# Spatially Continuous Data III {#spatially-continuous-data-iii}

Placeholder


## Learning objectives
## Suggested reading
## Preliminaries
## Residual spatial pattern
## Measuring spatial dependence in spatially continuous data
## Variographic analyisis

<!--chapter:end:35-Spatially-Continuous-Data-III.Rmd-->


# Activity 17: Spatially Continuous Data III

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:36-Activity-Spatially-Continuous-Data-III.Rmd-->


# Spatially Continuous Data IV

Placeholder


## Learning objectives
## Suggested reading
## Preliminaries
## Using residual spatial pattern to estimate prediction errors
## Kriging: a method for optimal prediction.

<!--chapter:end:37-Spatially-Continuous-Data-IV.Rmd-->


# Activity 18: Spatially Continuous Data IV

Placeholder


## Practice questions
## Learning objectives
## Suggested reading
## Preliminaries
## Activity

<!--chapter:end:38-Activity-Spatially-Continuous-Data-IV.Rmd-->

